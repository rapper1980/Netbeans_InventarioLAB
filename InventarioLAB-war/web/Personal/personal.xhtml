<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:rich="http://richfaces.org/rich">
    <h:outputStylesheet name="">
        a.no-decor>img {
        border: none;
        }
    </h:outputStylesheet>
    <body>
        <ui:composition template="./../main.xhtml">
            <ui:define name="cuerpo">
                <h2>Gestion de Personal</h2>
                <rich:panel header="Filtros">
                    <h:form styleClass="buscar">
                        <h:panelGrid columns="3">
                            <h:outputLabel value="Codigo" />
                            <h:inputText />
                            <rich:message />

                            <h:outputLabel value="Serie" />
                            <h:inputText />
                            <rich:message />

                            <h:outputLabel value="Estado" />
                            <h:selectOneMenu>
                                <f:selectItem itemLabel="Disponibles" />
                                <f:selectItem itemLabel="Prestados" />
                                <f:selectItem itemLabel="Dañados" />
                            </h:selectOneMenu>
                            <rich:message />

                            <h:outputLabel value="Tipo" />
                            <h:selectOneMenu>
                                <f:selectItem itemLabel="Prestable" />
                                <f:selectItem itemLabel="No Prestados" />
                                <f:selectItem itemLabel="Prestable con Autorizacion" />
                            </h:selectOneMenu>
                            <rich:message />

                            <f:facet name="footer">
                                <h:commandButton value="Buscar" />
                            </f:facet>
                        </h:panelGrid>
                    </h:form>
                </rich:panel>

                <a4j:status onstart="#{rich:component('statPane')}.show()" onstop="#{rich:component('statPane')}.hide()" />
                <h:form id="form">
                    <rich:panel header="Lista del Personal">
                        <rich:dataTable id="listaPersonal" value="#{personalBean.todosUsuarios}"
                                        var="personal" iterationStatusVar="it" rows="10">
                            <rich:column>
                                <f:facet name="header">Usuario</f:facet>
                                #{personal.usuario}
                            </rich:column>
                            <rich:column>
                                <f:facet name="header">Matricula</f:facet>
                                #{personal.idPersona.estudianteEspol.matricula}
                            </rich:column>
                            <rich:column>
                                <f:facet name="header">Tipo Idetificacion</f:facet>
                                #{personal.idPersona.tipoIdentificacion}
                            </rich:column>
                            <rich:column>
                                <f:facet name="header">Identificacion</f:facet>
                                #{personal.idPersona.identificacion}
                            </rich:column>
                            <rich:column>
                                <f:facet name="header">Nombres</f:facet>
                                #{personal.idPersona.nombres}
                            </rich:column>
                            <rich:column>
                                <f:facet name="header">Apellidos</f:facet>
                                #{personal.idPersona.apellidos}
                            </rich:column>
                            <rich:column>
                                <f:facet name="header">Email</f:facet>
                                #{personal.idPersona.estudianteEspol.email}
                            </rich:column>
                            <rich:column>
                                <f:facet name="header">Opciones</f:facet>
                                <a4j:commandLink styleClass="no-decor" render="editGrid" execute="@this"
                                                 oncomplete="#{rich:component('editPane')}.show()">
                                    <h:graphicImage value="../imagenes/tools/edit.gif" alt="edit" />
                                    <a4j:param value="#{it.index}" assignTo="#{personalBean.indiceActual}" />
                                    <f:setPropertyActionListener target="#{personalBean.usuarioEditar}" value="#{personal}" />
                                </a4j:commandLink>
                                <a4j:commandLink styleClass="no-decor" execute="@this" render="@none"
                                                 oncomplete="#{rich:component('confirmPane')}.show()">
                                    <h:graphicImage value="../imagenes/tools/delete.gif" alt="delete" />
                                    <a4j:param value="#{it.index}" assignTo="#{personalBean.indiceActual}" />
                                </a4j:commandLink>
                            </rich:column>
                            <f:facet name="footer">
                                <rich:dataScroller page="#{personalBean.pagina}" />
                            </f:facet>
                        </rich:dataTable>

                    </rich:panel>
                    <a4j:jsFunction name="eliminar" action="#{personalBean.eliminar()}" render="table" execute="@this"
                                    oncomplete="#{rich:component('confirmPane')}.hide();" />

                    <rich:popupPanel id="statPane" autosized="true">
                        <h:graphicImage value="../imagenes/tools/ai.gif" alt="ai" />
                        Por favor espere...
                    </rich:popupPanel>

                    <rich:popupPanel id="confirmPane" autosized="true">
                        ¿Esta seguro de eliminar el registro?
                        <a4j:commandButton value="Cancelar" onclick="#{rich:component('confirmPane')}.hide(); return false;" />
                        <a4j:commandButton value="Eliminar" onclick="eliminar(); return false;" />
                    </rich:popupPanel>

                    <!-- FALTA PERSONALIZAR-->
                    <rich:popupPanel header="Editar usuario" id="editPane" domElementAttachment="parent" width="400" height="170">
                        <h:panelGrid columns="3" id="editGrid">
                            <h:outputText value="Usuario" />
                            <h:outputText value="#{personalBean.usuarioEditar.idPersona.nombres}" />
                            <h:panelGroup />
                            <h:outputText value="Apellid" />
                            <h:outputText value="#{personalBean.usuarioEditar.idPersona.apellidos}" />
                            <h:panelGroup />
                            <h:outputText value="Email" />
                            <h:inputText value="#{personalBean.usuarioEditar.idPersona.estudianteEspol.email}" required="true" requiredMessage="Price is required" id="price"
                                         converterMessage="Should be a valid price" validatorMessage="Should be a valid price" label="Price field">
                                <f:validateDoubleRange minimum="0.00" maximum="99999999"/>
                            </h:inputText>
                            <rich:message id="priceMsg" for="price" />
                            <h:outputText value="Mileage" />
                            <h:inputText value="#{personalBean.usuarioEditar.idPersona.estudianteEspol.email}" id="mage" converterMessage="Should be a valid mileage"
                                         validatorMessage="Should be a valid mileage" label="Mileage field">
                                <f:validateDoubleRange minimum="0.00" maximum="99999999.00" />
                            </h:inputText>
                            <rich:message id="madeMsg" for="mage" />
                            <h:outputText value="VIN" />
                            <h:inputText value="#{personalBean.usuarioEditar.idPersona.estudianteEspol.email}" id="vin" required="true"
                                         validatorMessage="Not a valid 17-digit VIN" converterMessage="Not a valid 17-digit VIN"
                                         requiredMessage="VIN is required">
                                <f:validateLength minimum="17" maximum="17" />
                            </h:inputText>
                            <rich:message id="vinMsg" for="vin" />
                        </h:panelGrid>
                        <a4j:commandButton value="Grabar" action="#{personalBean.grabar()}" render="table" execute="editPane"
                                           oncomplete="if (#{facesContext.maximumSeverity==null}) {#{rich:component('editPane')}.hide();}" />
                        <a4j:commandButton value="Cancelar" onclick="#{rich:component('editPane')}.hide(); return false;" />
                    </rich:popupPanel>
                </h:form>
            </ui:define>
        </ui:composition>

    </body>
</html>
